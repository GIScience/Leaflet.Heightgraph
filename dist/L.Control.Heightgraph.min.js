"use strict";L.Control.Heightgraph=L.Control.extend({options:{position:"bottomright",width:800,height:280,margins:{top:10,right:30,bottom:55,left:50},mappings:void 0,expand:!0,expandControls:!0,translation:{},expandCallback:void 0,xTicks:void 0,yTicks:void 0,highlightStyle:void 0},_defaultTranslation:{distance:"Distance",elevation:"Elevation",segment_length:"Segment length",type:"Type",legend:"Legend"},_init_options:function(){this._margin=this.options.margins,this._width=this.options.width,this._height=this.options.height,this._mappings=this.options.mappings,this._svgWidth=this._width-this._margin.left-this._margin.right,this._svgHeight=this._height-this._margin.top-this._margin.bottom,this._selectedOption=0,this._highlightStyle=this.options.highlightStyle||{color:"red"}},onAdd:function(){var t=this._container=L.DomUtil.create("div","heightgraph");if(L.DomEvent.disableClickPropagation(t),this.options.expandControls){var e=this._button=L.DomUtil.create("div","heightgraph-toggle",t);L.DomUtil.create("a","heightgraph-toggle-icon",e),this._closeButton=L.DomUtil.create("a","heightgraph-close-icon",t)}this._showState=!1,this._initToggle(),this._init_options();this._svg=d3.select(this._container).append("svg").attr("class","heightgraph-container").attr("width",this._svgWidth+this._margin.left+this._margin.right).attr("height",this._svgHeight+this._margin.top+this._margin.bottom).append("g").attr("transform","translate("+this._margin.left+","+this._margin.top+")");return t},onRemove:function(){this._removeMarkedSegmentsOnMap(),this._container=null,this._svg=void 0},addData:function(t){void 0!==this._svg&&this._svg.selectAll("*").remove(),this._data=t,this._prepareData(),this._computeStats(),this._onAddData()},_onAddData:function(){this._init_options(),this._appendScales(),this._appendGrid(),this._createChart(this._selectedOption),1<this._data.length&&this._createSelectionBox(),this.options.expand&&this._expand()},_initToggle:function(){L.Browser.touch?L.DomEvent.on(this._container,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(this._container),this.options.expandControls&&(L.DomEvent.on(this._button,"click",this._expand,this),L.DomEvent.on(this._closeButton,"click",this._expand,this))},_dragHandler:function(){d3.event.preventDefault(),d3.event.stopPropagation(),this._gotDragged=!0,this._drawDragRectangle()},_drawDragRectangle:function(){if(this._dragStartCoords){var t=this._dragCurrentCoords=d3.mouse(this._background.node()),e=Math.min(this._dragStartCoords[0],t[0]),i=Math.max(this._dragStartCoords[0],t[0]);if(this._dragRectangle||this._dragRectangleG)this._dragRectangle.attr("width",i-e).attr("x",e);else{var s=d3.select(this._container).select("svg").select("g");this._dragRectangleG=s.append("g"),this._dragRectangle=this._dragRectangleG.append("rect").attr("width",i-e).attr("height",this._svgHeight).attr("x",e).attr("class","mouse-drag").style("fill","grey").style("opacity",.5).style("pointer-events","none")}}},_resetDrag:function(){if(this._dragRectangleG){this._dragRectangleG.remove(),this._dragRectangleG=null,this._dragRectangle=null;var t=this._calculateFullExtent(this._areasFlattended);t&&this._map.fitBounds(t)}},_dragEndHandler:function(){if(!this._dragStartCoords||!this._gotDragged)return this._dragStartCoords=null,this._gotDragged=!1,void this._resetDrag();var t=this._findItemForX(this._dragStartCoords[0]),e=this._findItemForX(this._dragCurrentCoords[0]);this._fitSection(t,e),this._dragStartCoords=null,this._gotDragged=!1},_dragStartHandler:function(){d3.event.preventDefault(),d3.event.stopPropagation(),this._gotDragged=!1,this._dragStartCoords=d3.mouse(this._background.node())},_calculateFullExtent:function(t){if(!t||t.length<1)return null;var e=new L.latLngBounds(t[0].latlng,t[0].latlng);return t.forEach(function(t){e.contains(t.latlng)||e.extend(t.latlng)}),e},_fitSection:function(t,e){var i,s=Math.min(t,e),a=Math.max(t,e);s!==a?i=this._calculateFullExtent(this._areasFlattended.slice(s,a+1)):0<this._areasFlattended.length&&(i=[this._areasFlattended[s].latlng,this._areasFlattended[a].latlng]),i&&this._map.fitBounds(i)},_expand:function(){!0!==this.options.expandControls&&(this._showState=!1),this._showState?(d3.select(this._button).style("display","block"),d3.select(this._container).selectAll("svg").style("display","none"),d3.select(this._closeButton).style("display","none")):(d3.select(this._button).style("display","none"),d3.select(this._container).selectAll("svg").style("display","block"),d3.select(this._closeButton).style("display","block")),this._showState=!this._showState,"function"==typeof this.options.expandCallback&&this.options.expandCallback(this._showState)},_removeChart:function(){void 0!==this._svg&&(this._svg.selectAll("path.area").remove(),this._svg.selectAll("path.border-top").remove(),this._svg.selectAll(".legend").remove(),this._svg.selectAll(".lineSelection").remove(),this._svg.selectAll(".horizontalLine").remove(),this._svg.selectAll(".horizontalLineText").remove())},_randomNumber:function(t){return Math.round(Math.random()*(t-0))},_d3ColorCategorical:[{name:"schemeAccent"},{name:"schemeDark2"},{name:"schemeSet2"},{name:"schemeSet1"},{name:"schemeCategory10"},{name:"schemeSet3"},{name:"schemePaired"},{name:"schemeCategory20"},{name:"schemeCategory20b"},{name:"schemeCategory20c"}],_prepareData:function(){this._profile={},this._profile.coordinates=[],this._profile.elevations=[],this._profile.cumDistances=[],this._profile.cumDistances.push(0),this._profile.blocks=[];var t,e=this._data;if(void 0===this._mappings){var i=this._randomNumber([].length);t=d3.scaleOrdinal(d3[this._d3ColorCategorical[i].name])}for(var s=0;s<e.length;s++){var a=0;this._profile.blocks[s]={},this._profile.blocks[s].info={id:s,text:e[s].properties.summary},this._profile.blocks[s].distances=[],this._profile.blocks[s].attributes=[],this._profile.blocks[s].geometries=[],this._profile.blocks[s].legend={};var n=void 0,o=0,r={};for(n=0;n<e[s].features.length;n++){var l=void 0,h=void 0,c=void 0,d=[],_=e[s].features[n].geometry.coordinates.length,g=e[s].features[n].properties.attributeType,p=void 0,u=void 0;void 0===this._mappings?g in r?u=r[p=g]:(p=g,u=t(n),r[g]=u):(p=this._mappings[e[s].properties.summary][g].text,u=this._mappings[e[s].properties.summary][g].color);var m={type:g,text:p,color:u};this._profile.blocks[s].attributes.push(m),g in this._profile.blocks[s].legend||(this._profile.blocks[s].legend[g]=m);for(var f=0;f<_;f++){h=new L.LatLng(e[s].features[n].geometry.coordinates[f][1],e[s].features[n].geometry.coordinates[f][0]),l=e[s].features[n].geometry.coordinates[f][2],f<_-1?(c=new L.LatLng(e[s].features[n].geometry.coordinates[f+1][1],e[s].features[n].geometry.coordinates[f+1][0]),a+=h.distanceTo(c)/1e3,0===s&&(this._profile.elevations.push(l),this._profile.coordinates.push(h),this._profile.cumDistances.push(a)),o+=1):f===_-1&&n===e[s].features.length-1&&(0===s&&(this._profile.elevations.push(l),this._profile.coordinates.push(c)),o+=1);var v=void 0;v=f===_-1&&n<e[s].features.length-1?this._profile.cumDistances[o]:this._profile.cumDistances[o-1],d.push({altitude:l,position:v,x:h.lng,y:h.lat,latlng:h,type:p,areaIdx:n})}this._profile.blocks[s].distances.push(a),this._profile.blocks[s].geometries.push(d)}s===e.length-1&&(this._profile.totalDistance=a)}},_computeStats:function(){var t=this._profile.maxElevation=d3.max(this._profile.elevations),e=this._profile.minElevation=d3.min(this._profile.elevations),i=this._profile.elevationQuantile=d3.quantile(this._profile.elevations,.75);this._profile.yElevationMin=i<e+e/10?e-t/5<0?0:e-t/5:e-t/10,this._profile.yElevationMax=t-t/10<i?t+t/3:t},_showMarker:function(t,e,i){var s=this._map.latLngToLayerPoint(t),a=s.y-75;if(!this._mouseHeightFocus){var n=d3.select(".leaflet-overlay-pane svg").append("g");this._mouseHeightFocus=n.append("svg:line").attr("class","height-focus line").attr("x2","0").attr("y2","0").attr("x1","0").attr("y1","0"),this._mouseHeightFocusLabel=n.append("g").attr("class","height-focus label"),this._mouseHeightFocusLabelRect=this._mouseHeightFocusLabel.append("rect").attr("class","bBox"),this._mouseHeightFocusLabelTextElev=this._mouseHeightFocusLabel.append("text").attr("class","tspan"),this._mouseHeightFocusLabelTextType=this._mouseHeightFocusLabel.append("text").attr("class","tspan"),(this._pointG=n.append("g").attr("class","height-focus circle")).append("svg:circle").attr("r",5).attr("cx",0).attr("cy",0).attr("class","height-focus circle-lower")}this._mouseHeightFocusLabel.style("display","block"),this._mouseHeightFocus.attr("x1",s.x).attr("x2",s.x).attr("y1",s.y).attr("y2",a).style("display","block"),this._pointG.attr("transform","translate("+s.x+","+s.y+")").style("display","block"),this._mouseHeightFocusLabelRect.attr("x",s.x+3).attr("y",a).attr("class","bBox"),this._mouseHeightFocusLabelTextElev.attr("x",s.x+5).attr("y",12+a).text(e+" m").attr("class","tspan mouse-height-box-text"),this._mouseHeightFocusLabelTextType.attr("x",s.x+5).attr("y",24+a).text(i).attr("class","tspan mouse-height-box-text");var o=this._dynamicBoxSize("text.tspan")[1],r=""===i?18:30;d3.selectAll(".bBox").attr("width",o+10).attr("height",r)},_createChart:function(t){var e=0==this._profile.blocks.length?[]:this._profile.blocks[t].geometries;this._areasFlattended=[].concat.apply([],e);for(var i=0;i<e.length;i++)this._appendAreas(e[i],t,i);this._createFocus(),this._appendBackground(),this._createBorderTopLine(),this._createLegend(),this._createHorizontalLine()},_createFocus:function(){var t=this._profile.yElevationMin;this._focus&&(this._focus.remove(),this._focusLineGroup.remove()),this._focus=this._svg.append("g").attr("class","focusbox"),this._focusRect=this._focus.append("rect").attr("x",3).attr("y",-this._y(t)).attr("display","none"),this._focusDistance=this._focus.append("text").attr("x",7).attr("y",15-this._y(t)).attr("id","heightgraph.distance").text(this._getTranslation("distance")+":"),this._focusHeight=this._focus.append("text").attr("x",7).attr("y",30-this._y(t)).attr("id","heightgraph.height").text(this._getTranslation("elevation")+":"),this._focusBlockDistance=this._focus.append("text").attr("x",7).attr("y",45-this._y(t)).attr("id","heightgraph.blockdistance").text(this._getTranslation("segment_length")+":"),this._focusType=this._focus.append("text").attr("x",7).attr("y",60-this._y(t)).attr("id","heightgraph.type").text(this._getTranslation("type")+":"),this._areaTspan=this._focusBlockDistance.append("tspan").attr("class","tspan"),this._typeTspan=this._focusType.append("tspan").attr("class","tspan");var e=this._dynamicBoxSize(".focusbox text")[0];d3.selectAll(".focusbox rect").attr("height",15*e+7.5).attr("display","block"),this._focusLineGroup=this._svg.append("g").attr("class","focusLine"),this._focusLine=this._focusLineGroup.append("line").attr("y1",0).attr("y2",this._y(this._profile.yElevationMin)),this._distTspan=this._focusDistance.append("tspan").attr("class","tspan"),this._altTspan=this._focusHeight.append("tspan").attr("class","tspan")},_createHorizontalLine:function(){var t=this;this._horizontalLine=this._svg.append("line").attr("class","horizontalLine").attr("x1",0).attr("x2",this._width-this._margin.left-this._margin.right).attr("y1",this._y(this._profile.yElevationMin)).attr("y2",this._y(this._profile.yElevationMin)).style("stroke","black"),this._elevationValueText=this._svg.append("text").attr("class","horizontalLineText").attr("x",this._width-this._margin.left-this._margin.right-20).attr("y",this._y(this._profile.yElevationMin)-10).attr("fill","black");var e=[{x:this._width-this._margin.left-this._margin.right+7,y:this._y(this._profile.yElevationMin),color:"black",type:d3.symbolTriangle,angle:-90,size:100}];this._svg.selectAll(".horizontal-symbol").data(e).enter().append("path").attr("class","lineSelection").attr("d",d3.symbol().type(function(t){return t.type}).size(function(t){return t.size})).attr("transform",function(t){return"translate("+t.x+","+t.y+") rotate("+t.angle+")"}).attr("id",function(t){return t.id}).style("fill",function(t){return t.color}).call(d3.drag().on("start",function(){d3.select(this).raise().classed("active",!0),d3.select(".horizontalLine").raise().classed("active",!0)}).on("drag",function(){var e=t._svgHeight,i=d3.mouse(t._container)[1]-10;d3.select(this).attr("transform",function(t){return"translate("+t.x+","+(i<0?0:e<i?e:i)+") rotate("+t.angle+")"}),d3.select(".horizontalLine").attr("y1",i<0?0:e<i?e:i).attr("y2",i<0?0:e<i?e:i),t._highlightedCoords=e<=i?[]:t._findCoordsForY(i),d3.select(".horizontalLineText").attr("y",i<=10?0:e<i?e-10:i-10).text(d3.format(".0f")(t._y.invert(i<0?0:e<i?e:i))+" m"),t._removeMarkedSegmentsOnMap(),t._markSegmentsOnMap(t._highlightedCoords)}).on("end",function(){d3.select(this).classed("active",!1),d3.select(".horizontalLine").classed("active",!1),t._removeMarkedSegmentsOnMap(),t._markSegmentsOnMap(t._highlightedCoords)}))},_markSegmentsOnMap:function(t){if(t)if(1<t.length){this._markedSegments=L.featureGroup();var e=!0,i=!1,s=void 0;try{for(var a,n=t[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var o=a.value;L.polyline(o,this._highlightStyle).addTo(this._markedSegments)}}catch(t){i=!0,s=t}finally{try{e||null==n.return||n.return()}finally{if(i)throw s}}this._markedSegments.addTo(this._map).bringToFront()}else this._markedSegments=L.polyline(t,this._highlightStyle).addTo(this._map)},_removeMarkedSegmentsOnMap:function(){void 0!==this._markedSegments&&this._map.removeLayer(this._markedSegments)},_appendScales:function(){var t=Boolean(this._profile.totalDistance<=10),e=this._profile.yElevationMin,i=this._profile.yElevationMax,s=(this._margin,this._width-this._margin.left-this._margin.right),a=this._height-this._margin.top-this._margin.bottom;this._x=d3.scaleLinear().range([0,s]),this._y=d3.scaleLinear().range([a,0]),this._x.domain([0,this._profile.totalDistance]),this._y.domain([e,i]),this._xAxis=!0===t?d3.axisBottom().scale(this._x).tickFormat(function(t){return d3.format(".2f")(t)+" km"}):d3.axisBottom().scale(this._x).tickFormat(function(t){return d3.format(".0f")(t)+" km"}),void 0!==this.options.xTicks&&this._xAxis.ticks(Math.pow(2,this.options.xTicks)),this._yAxis=d3.axisLeft().scale(this._y).tickFormat(function(t){return t+" m"}),void 0!==this.options.yTicks&&this._yAxis.ticks(Math.pow(2,this.options.yTicks)),this._yEndAxis=d3.axisRight().scale(this._yEnd).ticks(0)},_appendBackground:function(){var t=this._background=d3.select(this._container).select("svg").select("g").append("rect").attr("width",this._svgWidth).attr("height",this._svgHeight).style("fill","none").style("stroke","none").style("pointer-events","all").on("mousemove.focusbox",this._mousemoveHandler.bind(this)).on("mouseout.focusbox",this._mouseoutHandler.bind(this));L.Browser.android?(t.on("touchstart.drag",this._dragHandler.bind(this)).on("touchstart.drag",this._dragStartHandler.bind(this)).on("touchstart.focusbox",this._mousemoveHandler.bind(this)),L.DomEvent.on(this._container,"touchend",this._dragEndHandler,this)):(t.on("mousemove.focusbox",this._mousemoveHandler.bind(this)).on("mouseout.focusbox",this._mouseoutHandler.bind(this)).on("mousedown.drag",this._dragStartHandler.bind(this)).on("mousemove.drag",this._dragHandler.bind(this)),L.DomEvent.on(this._container,"mouseup",this._dragEndHandler,this))},_appendGrid:function(){this._svg.append("g").attr("class","grid").attr("transform","translate(0,"+this._svgHeight+")").call(this._make_x_axis().tickSize(-this._svgHeight,0,0).tickFormat("")),this._svg.append("g").attr("class","grid").call(this._make_y_axis().tickSize(-this._svgWidth,0,0).ticks(5).tickFormat("")),this._svg.append("g").attr("transform","translate(0,"+this._svgHeight+")").attr("class","x axis").call(this._xAxis),this._svg.append("g").attr("transform","translate(-2,0)").attr("class","y axis").call(this._yAxis)},_appendAreas:function(t,e,i){var s=this._profile.blocks[e].attributes[i].color,a=this;this._area=d3.area().x(function(t){var e=a._x(t.position);return t.xDiagonalCoordinate=e}).y0(this._svgHeight).y1(function(t){return a._y(t.altitude)}).curve(d3.curveLinear);this._areapath=this._svg.append("path").attr("class","area"),this._areapath.datum(t).attr("d",this._area).attr("stroke",s).style("fill",s).style("pointer-events","none")},_make_x_axis:function(){return d3.axisBottom().scale(this._x)},_make_y_axis:function(){return d3.axisLeft().scale(this._y)},_createSelectionBox:function(){function e(t){var e=[{selection:i._profile.blocks[t].info.text}];i._selectionText&&i._selectionText.remove(),i._selectionText=s.selectAll("selection_text").data(e).enter().append("text").attr("x",a-20).attr("y",50+n).text(function(t){return t.selection}).attr("class","select-info").attr("id","selectionText")}var i=this,s=d3.select(this._container).select("svg"),a=(this._margin,this._width-this._margin.left-this._margin.right),n=this._height-this._margin.top-this._margin.bottom,t=[{x:a-50,y:48+n,color:"#000",type:d3.symbolTriangle,id:"leftArrowSelection",angle:-360},{x:a-35,y:45+n,color:"#000",type:d3.symbolTriangle,id:"rightArrowSelection",angle:180}],o=(s.selectAll(".select-symbol").data(t).enter().append("path").attr("class","select-symbol").attr("d",d3.symbol().type(function(t){return t.type})).attr("transform",function(t){return"translate("+t.x+","+t.y+") rotate("+t.angle+")"}).attr("id",function(t){return t.id}).style("fill",function(t){return t.color}).on("click",function(t){"rightArrowSelection"===t.id&&r(),"leftArrowSelection"===t.id&&l()}),this._profile.blocks.length,this._selectedOption);e(o);var r=function(){var t=i._selectedOption+=1;t===i._profile.blocks.length&&(i._selectedOption=t=0),e(t),i._removeChart(),i._removeMarkedSegmentsOnMap(),i._createChart(t)},l=function(){var t=i._selectedOption-=1;-1===t&&(i._selectedOption=t=i._profile.blocks.length-1),e(t),i._removeChart(),i._removeMarkedSegmentsOnMap(),i._createChart(t)}},_createLegend:function(){var s=this,t=[];if(0<this._profile.blocks.length)for(var e in this._profile.blocks[this._selectedOption].legend)t.push(this._profile.blocks[this._selectedOption].legend[e]);this._margin,this._width,this._margin.left,this._margin.right;var a=this._height-this._margin.top-this._margin.bottom,i=[{text:this._getTranslation("legend")}],n=this._svg.selectAll(".hlegend-hover").data(t).enter().append("g").attr("class","legend").style("display","none").attr("transform",function(t,e){return"translate(-8,"+(14*e-28)+")"});n.append("rect").attr("class","legend-rect").attr("x",15).attr("y",36).attr("width",6).style("stroke","black").attr("height",6).style("fill",function(t,e){return t.color}),n.append("text").attr("class","legend-text").attr("x",30).attr("y",42).text(function(t,e){var i=t.text;return s._boxBoundY=(a-2*a/3+7)*e,i}),this._svg.selectAll(".legend-hover").data(i).enter().append("g").attr("class","legend-hover").append("text").attr("class","legend-menu").attr("class","no-select").attr("x",15).attr("y",40+a).text(function(t,e){return t.text}).on("mouseover",function(){d3.select(".legend-box").style("display","block"),d3.selectAll(".legend").style("display","block")}).on("mouseleave",function(){d3.select(".legend-box").style("display","none"),d3.selectAll(".legend").style("display","none")})},_dynamicBoxSize:function(t){for(var e=d3.selectAll(t).nodes().length,i=[],s=0;s<e;s++)i.push(d3.selectAll(t).nodes()[s].getBoundingClientRect().width);return[e,d3.max(i)]},_createBorderTopLine:function(){var e=this,t=this._areasFlattended,i=d3.line().x(function(t){return(0,e._x)(t.position)}).y(function(t){return(0,e._y)(t.altitude)}).curve(d3.curveBasis);this._svg.append("svg:path").attr("d",i(t)).attr("class","border-top")},_mouseoutHandler:function(){for(var t=0,e=["_focusLine","_focus","_pointG","_mouseHeightFocus","_mouseHeightFocusLabel"];t<e.length;t++){var i=e[t];this[i]&&this[i].style("display","none")}},_mapMousemoveHandler:function(t){if(!1!==this._areasFlattended){var e=null,s=2*Math.pow(100,2),a=1.1/111111;for(i=0;i<this._areasFlattended.length;i++){var n=this._areasFlattended[i],o=t.latlng.lat-n.latlng.lat,r=t.latlng.lng-n.latlng.lng;if(Math.abs(o)<a&&Math.abs(r)<a){this._internalMousemoveHandler(n);break}var l=Math.pow(o,2)+Math.pow(r,2);l<s&&(e=n,s=l)}e&&this._internalMousemoveHandler(e)}},_mousemoveHandler:function(){var t=d3.mouse(this._svg.node()),e=this._areasFlattended[this._findItemForX(t[0])];e&&this._internalMousemoveHandler(e)},_internalMousemoveHandler:function(t){var e,i=t.altitude,s=t.position,a=t.latlng,n=t.areaIdx,o=t.type,r=this._dynamicBoxSize(".focusbox text")[1]+10;e=0===n?this._profile.blocks[this._selectedOption].distances[n]:this._profile.blocks[this._selectedOption].distances[n]-this._profile.blocks[this._selectedOption].distances[n-1],this._showMarker(a,i,o),this._distTspan.text(" "+s.toFixed(1)+" km"),this._altTspan.text(" "+i+" m"),this._areaTspan.text(" "+e.toFixed(1)+" km"),this._typeTspan.text(" "+o),this._focusRect.attr("width",r),this._focusLine.style("display","block").attr("x1",this._x(s)).attr("x2",this._x(s));var l=this._x(s)-(r+5),h=this._width-this._margin.left-this._margin.right;this._x(s)+r<h&&this._focus.style("display","initial").attr("transform","translate("+this._x(s)+","+this._y(this._profile.yElevationMin)+")"),this._x(s)+r>h&&this._focus.style("display","initial").attr("transform","translate("+l+","+this._y(this._profile.yElevationMin)+")")},_findItemForX:function(t){var e=d3.bisector(function(t){return t.position}).left,i=this._x.invert(t);return e(this._areasFlattended,i)},_findCoordsForY:function(t){var e=this._y.invert(t);return function(t,e){for(var i=[],s=0;s<t.length;s++)t[s].altitude>=e&&i.push(s);for(var a=[],n=0,o=0;o<i.length-1;o++)i[o+1]!==i[o]+1&&(a.push(i.slice(n,o+1)),n=o+1);a.push(i.slice(n,i.length));for(var r=0;r<a.length;r++)for(var l=0;l<a[r].length;l++)a[r][l]=t[a[r][l]].latlng;return a}(this._areasFlattended,e)},_getTranslation:function(t){return this.options.translation[t]?this.options.translation[t]:this._defaultTranslation[t]?this._defaultTranslation[t]:(console.error("Unexpected error when looking up the translation for "+t),"No translation found")}}),L.control.heightgraph=function(t){return new L.Control.Heightgraph(t)};